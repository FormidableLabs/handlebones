<html>
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="mocha/mocha.css" />
  </head>
  <body>
    <div id="mocha"></div>
    <div id="fixture"></div>
    <script src="requirejs/require.js"></script>
    <script src="sinonjs/sinon.js"></script>
    <script src="mocha/mocha.js"></script>
    <script>
      // Set up Mocha.
      mocha.setup("bdd");
      mocha.reporter("html");

      // AMD setup.
      require.config({
        paths: {
          "zepto": "zepto/zepto",
          "underscore": "underscore/underscore",
          "backbone": "backbone/backbone",
          "Handlebars": "handlebars/handlebars",
        },
        map: {
          "*": {
            // Handlebars is used variously by different vendors. Do both here.
            "handlebars": "Handlebars"
          }
        },
        shim: {
          "Handlebars": {
            exports: "Handlebars"
          },
          "zepto": {
            exports: "$"
          }
        }
      });
      
      require(["chai/chai"], function (chai) {
        // Set up AMD Chai (just make global for test cases).
        window.chai = chai;
        window.expect = chai.expect;
        
        require(["zepto", "backbone"], function ($, Backbone) {
          Backbone.$ = $;

          // Add in specs.
          require(["test.js"], function () {
            (window.mochaPhantomJS || mocha).run();
          });
        });

      });
    </script>
  </body>
</html>